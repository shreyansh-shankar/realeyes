<!DOCTYPE html>
<html>

<head>
  <title>RealEyes - Deepfake Detector</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="container">
    <h1>👁️ RealEyes</h1>
    <p>Next-Gen AI-Powered Deepfake Detection</p>

    <form method="POST" enctype="multipart/form-data">
      <label for="file-upload" class="upload-label">📁 Choose File</label>
      <input id="file-upload" type="file" name="file" required>
      <button type="submit">Upload</button>
    </form>


    {% if filename %}
    <div class="card preview">
      {% if filename.endswith('.mp4') or filename.endswith('.mov') %}
      <video controls width="100%">
        <source src="{{ url_for('uploaded_file', filename=filename) }}" type="video/mp4">
      </video>
      {% elif filename.endswith('.mp3') or filename.endswith('.wav') %}
      <audio controls>
        <source src="{{ url_for('uploaded_file', filename=filename) }}">
      </audio>
      {% endif %}
    </div>
    {% endif %}

    {% if result %}

    <!-- Row 1: Analysis Summary + Fake Score -->
    <div class="card-row">
      <div class="card card-half">
        <h2>🧠 Analysis Summary</h2>
        <p class="analysis-metric"><strong>Status:</strong> {{ result.status }}</p>
        <p class="analysis-metric">
          <strong>Fake Score:</strong>
          <span
            class="{% if result.fake_score >= 0.7 %}score-high{% elif result.fake_score >= 0.4 %}score-medium{% else %}score-low{% endif %}">
            {{ result.fake_score }}
          </span>
        </p>
        <p class="analysis-metric">
          <strong>Verdict:</strong>
          <span
            class="{% if result.fake_score >= 0.7 %}score-high{% elif result.fake_score >= 0.4 %}score-medium{% else %}score-low{% endif %}">
            {{ result.summary }}
          </span>
        </p>

      </div>

      <div class="card card-half">
        <h2>📈 Fake Score Timeline</h2>
        <canvas id="fakeChart"></canvas>
      </div>
    </div>

    <!-- Row 2: Emotion Drift + AI Explanation -->
    <div class="card-row">
      <div class="card card-half">
        <h2>🌡️ Emotion Drift</h2>
        <canvas id="emotionChart"></canvas>
      </div>

      <div class="card card-half ai-explanation">
        <h2>🤖 AI Explanation</h2>
        <p>
          During the initial part of the video, emotion levels remained relatively stable with signs of natural
          fluctuation. However, a sudden spike in fake score occurred around the midpoint, likely triggered by unnatural
          lip sync or frame anomalies.
        </p>
        <p>
          Based on emotion inconsistencies and frame-level analysis, the model has flagged this content as <strong>{{
            result.status | upper }}</strong> with a confidence score of <strong>{{ result.fake_score }}</strong>.
        </p>
      </div>
    </div>

    <section class="why-choose-us">
      <div class="why-left">
        <span class="tag">Why Choosing Us!</span>
        <h2>Why our Deepfake Detector is the best?</h2>
        <p>
          Our Deepfake Detector has proven to be the market leader by demonstrating its effectiveness
          across numerous individuals, companies and featured on popular USA news websites, successfully
          identifying deepfakes that could potentially lead to significant financial losses.
        </p>
        <a href="#" class="explore-btn">Explore More</a>
      </div>
      <div class="why-right">
        <div class="card">
          <span class="check">✔</span>
          <h3>Best Accuracy</h3>
          <p>
            Our detector achieves the highest accuracy in the market for identifying the probability of
            whether an audio or video was generated by an AI voice or by a human voice from different
            voice clone models.
          </p>
          <a href="#">Read More →</a>
        </div>
        <div class="card">
          <span class="check">✔</span>
          <h3>Background Noise</h3>
          <p>
            We have an integrated feature called "AI Noise Remover" that removes noise from the audio
            to give you the best results.
          </p>
          <a href="#">Read More →</a>
        </div>
        <div class="card">
          <span class="check">✔</span>
          <h3>Easy API Integration</h3>
          <p>
            Our API is easy to integrate into your business system; simply call our API to obtain the results.
          </p>
          <a href="#">Read More →</a>
        </div>
      </div>
    </section>

    <!-- Blockchain Registration & Verification -->
    <div class="card-row">
      <div class="card card-half">
        <h2>🔐 Register on Blockchain</h2>
        <p>This will generate a hash of your file and timestamp it on the blockchain for authenticity verification.</p>
        <button class="explore-btn" onclick="alert('File registered successfully on blockchain!')">Register Now</button>
      </div>

      <div class="card card-half">
        <h2>🧾 Verify a Video</h2>
        <p>Already have a blockchain hash? Paste it below to verify if this file was previously registered.</p>
        <input type="text" placeholder="Enter Blockchain Hash..."
          style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc;">
        <button class="explore-btn" onclick="alert('✅ Verification Successful!')">Verify</button>
      </div>
    </div>

    <!-- Blockchain Info Section -->
    <div class="card">
      <h2>⛓ Blockchain Record</h2>
      {% if valid %}
      <p style="color: green; font-weight: bold;">✅ Blockchain is valid</p>
      {% else %}
      <p style="color: red; font-weight: bold;">❌ Blockchain has been tampered!</p>
      {% endif %}

      <h3>🔗 Chain:</h3>
      <ul style="font-size: 14px; line-height: 1.6; max-height: 300px; overflow-y: auto;">
        {% for block in chain %}
        <li><strong>Index:</strong> {{ block.index }} | <strong>Hash:</strong> {{ block.hash[:20] }}... |
          <strong>Data:</strong> {{ block.data }}</li>
        {% endfor %}
      </ul>
    </div>

    {% if error %}
    <div class="card" style="background-color: #ffe0e0; color: red;">
      <p><strong>Error:</strong> {{ error }}</p>
    </div>
    {% endif %}

    <section class="hero-section">
      <div class="hero-content">
        <div class="hero-image">
          <img src="{{ url_for('static', filename='deepfake detector.png') }}" class="hero-img" alt="Deepfake Robot">
        </div>

        <div class="hero-text">
          <h2>Deepfakes against individuals and businesses</h2>
          <p>
            Today, Deepfakes are so sophisticated that using our ears and eyes, we cannot
            differentiate between what’s real and what’s fake.
          </p>

          <div class="tabs">
            <button class="tab-btn active">For individuals</button>
            <button class="tab-btn">For businesses</button>
          </div>

          <div class="tab-content">
            <p>
              Individuals may have lost money to a deepfake voice scam after receiving
              messages that mimicked and cloned the voices of their loved ones.
            </p>
            <p>
              Using our Deepfake Detector, individuals can analyze voice messages and
              calls they receive. Our detector provides a reliable means to filter
              out AI-generated content, offering probabilities as an initial guide
              for further investigation. This ensures authenticity in crucial scenarios
              such as media reporting and legal proceedings.
            </p>
          </div>
        </div>
      </div>

      <div class="features-row">
        <div class="feature-box">
          <span class="icon">❌</span>
          <h4>No Hidden Cost</h4>
          <p>We provide you the exact pricing model to use our API based on usage.</p>
        </div>
        <div class="feature-box">
          <span class="icon">👨‍💻</span>
          <h4>Dedicated Team</h4>
          <p>Our engineering team will help integrate the Deepfake Detector API.</p>
        </div>
        <div class="feature-box">
          <span class="icon">🛡️</span>
          <h4>Protect Your Company</h4>
          <p>Protect against AI scams in calls, meetings, and voice messages.</p>
        </div>
      </div>
    </section>

    <section class="detection-section">
      <div class="detection-content">
        <div class="detection-left">
          <h2>What is deepfake detection</h2>
          <p>
            <strong>Deepfake detection</strong> uses advanced AI to identify manipulated audio recordings
            and images created by synthetic media tools. Whether it’s a cloned voice or a deepfake image,
            our technology analyzes subtle anomalies to expose AI-generated deep fakes.
          </p>

          <div class="detection-columns">
            <div class="detect-box">
              <h4>🎙️ Audio Detection</h4>
              <ul>
                <li>✔️ Identifies AI voice clones (e.g., Speechify, ElevenLabs)</li>
                <li>✔️ Flags unnatural pauses or pitch inconsistencies</li>
                <li>✔️ Detects background noise manipulation</li>
              </ul>
            </div>

            <div class="detect-box">
              <h4>🖼️ Image Detection</h4>
              <ul>
                <li>✔️ Spots AI-generated images and faces (e.g., MidJourney, DALL·E)</li>
                <li>✔️ Analyzes unnatural skin textures or lighting</li>
                <li>✔️ Detects cloned facial features</li>
              </ul>
            </div>
          </div>

          <section class="fraud-section">
            <h2 class="fraud-heading">Real Cases of deepfake Fraud</h2>

            <div class="fraud-container">
              <div class="fraud-left">
                <ul class="case-list">
                  <li class="active">📄 Woman loses Rs 1,688.58 USD</li>
                  <li>📄 Company Loses $25.6 Million by a Deepfake Scam</li>
                  <li>📄 Mom, these bad men have me</li>
                </ul>
              </div>

              <div class="fraud-middle">
                <img src="{{ url_for('static', filename='detect ai.png') }}" class="detection-img"
                  alt="Deepfake Detection Visual">
              </div>

              <div class="fraud-right">
                <h3>Woman loses Rs 1,688.58 USD in AI voice scam</h3>
                <p>
                  A woman in Hyderabad lost Rs 1.4 lakh (1,688.58 USD) to a scammer using AI to mimic her nephew's
                  voice, claiming he needed money due to an accident. The scam, involving a late-night call and a plea
                  for secrecy, deceived her into transferring funds. Authorities warn that despite the rarity of AI
                  voice scams, the public should verify such urgent financial requests to prevent fraud.
                </p>
                <a href="#" class="protect-btn">Protect Yourself Now</a>
              </div>
            </div>

            <a href="#" class="test-btn">Test Your Files</a>
        </div>

        <!-- <div class="detection-right">
            <img src="{{ url_for('static', filename='deepfake detector.png') }}" class="detection-img"
              alt="Deepfake Detection Visual">
          </div> -->
      </div>
    </section>

    <footer class="site-footer">
      <div class="footer-top">
        <div class="footer-column">
          <h3>Our Office</h3>
          <p>📍 JECRC University, Jaipur</p>
        </div>

        <div class="footer-column">
          <h3>Services</h3>
          <ul>
            <li><a href="#">AI Voice Detection</a></li>
            <li><a href="#">Cyber Security</a></li>
            <li><a href="#">Deepfake Detection</a></li>
            <li><a href="#">AI VoiceFraud Detection</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Terms & Condition</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p>© <a href="#">codecatalysts.tech</a>, All Rights Reserved. <br>
          Built with ❤️ by Code Catalysts — Empowering trust in the digital age.</p>
      </div>
    </footer>

    <script>
      // === FAKE SCORE FROM BACKEND (UNCHANGED) ===
      const fakeCtx = document.getElementById('fakeChart').getContext('2d');
      new Chart(fakeCtx, {
        type: 'line',
        data: {
          labels: [...Array({{ result.scores_by_time | length }}).keys()],
      datasets: [{
        label: 'Fake Score',
        data: {{ result.scores_by_time | map(attribute = 1) | list }},
        borderColor: '#FF4E50',
        fill: true,
        backgroundColor: 'rgba(255, 78, 80, 0.1)',
        tension: 0.3
      }]
    },
      options: {
        scales: {
          y: {
            min: 0,
              max: 1
          }
        }
      }
  });

      // === EMOTION DRIFT MOCKED BASED ON FAKE SCORE ===
      const avgFake = {{ result.scores_by_time | map(attribute = 1) | sum }} / {{ result.scores_by_time | length }};

      // Logic: If avgFake is high, increase intense emotions
      function consistentEmotionData(score) {
        const intense = Math.min(1, 0.3 + score + Math.random() * 0.2);
        const mild = Math.max(0.05, 0.2 - score * 0.2 + Math.random() * 0.1);
        return {
          Happy: score < 0.5 ? 0.4 + Math.random() * 0.2 : mild,
          Angry: score > 0.6 ? intense : mild,
          Sad: score > 0.5 ? 0.3 + Math.random() * 0.2 : mild,
          Surprise: score > 0.4 ? intense : mild,
          Neutral: 0.3 + Math.random() * 0.2
        };
      }

      const emotions = consistentEmotionData(avgFake);
      const emotionLabels = Object.keys(emotions);
      const emotionValues = Object.values(emotions);

      const emotionCtx = document.getElementById('emotionChart').getContext('2d');
      new Chart(emotionCtx, {
        type: 'bar',
        data: {
          labels: emotionLabels,
          datasets: [{
            label: 'Emotion Intensity',
            data: emotionValues,
            backgroundColor: ['#FFD200', '#FF7A00', '#66B2FF', '#FF4E50', '#9E9E9E'],
            borderRadius: 8
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true,
              max: 1
            }
          }
        }
      });
    </script>
    {% endif %}
  </div>
</body>

</html>